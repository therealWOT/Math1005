# finds total cars per day for year xxxx
getdata <- function(y){
df = read.csv("32029 - Burns Bay Road.csv")
frame = df[df$classification_seq == "All Vehicles",]
year = frame[frame$year == y,]
direction = year[year$cardinal_direction_seq == "Northbound",]
dailytraffic = rowSums(direction[,c(5:28)])
filtereddaily = dailytraffic[complete.cases(dailytraffic)]
filteredframe = direction[complete.cases(dailytraffic),]
newframe = cbind(filteredframe,filtereddaily)
newframe$date = as.Date(newframe$date, format = "%d/%m/%Y")
return(newframe)
}

scatterplot <- function(y){
  a = getdata(y)
  plot(a$date,a$filtereddaily)
  abline(lm(a$filtereddaily~a$date), col="blue")
}

residuals <- function(y){
  a = getdata(y)
  l=lm(a$filtereddaily~a$date)
  plot(a$date, l$residuals, ylab="residuals")
  abline(h=0, col="red")
}
boxplot <- function(y){
  a = getdata(y)
  boxplot(a$filtereddaily)
}



compareboxplot <- function(x,y){
a = getdata(x)
b = getdata(y)

boxplot(a$filtereddaily,b$filtereddaily, ylab = "cars", names = c(as.character(x),as.character(y)))
}


boxplot(2021)



